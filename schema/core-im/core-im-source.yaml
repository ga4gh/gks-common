$schema: "https://json-schema.org/draft/2020-12/schema"
$id: "https://w3id.org/ga4gh/schema/gks-core-im/1.x/core-im/core-im-source.yaml"
title: GKS Commons Core Information Class Definitions

imports:
  gks.data-types: ../data-types/data-types-source.yaml

$defs:
  Entity:
    description: >-
      Entity is the root class of the 'gks-common' core information model classes - those that
      have identifiers and other general metadata like labels, xrefs, urls, descriptions, etc.
      All common classes descend from and inherit its attributes.
    heritableProperties:
      id:
        type: string
        description: >-
          The 'logical' identifier of the entity in the system of record, e.g. a UUID. This 'id' is
          unique within a given system. The identified entity may have a different 'id' in a different
          system, or may refer to an 'id' for the shared concept in another system (e.g. a CURIE).
      type:
        type: string
      label:
        type: string
        description: A primary name for the entity.
      description:
        type: string
        description: A free-text description of the entity.
      alternativeLabels:
        type: array
        ordered: false
        items:
          type: string
        description: Alternative name(s) for the Entity.
      extensions:
        type: array
        ordered: false
        items:
          $ref: "/ga4gh/schema/gks-common/1.x/data-types/json/Extension"
        description: >-
          A list of extensions to the entity. Extensions are not expected to be natively understood,
          but may be used for pre-negotiated exchange of message attributes between systems.
    heritableRequired:
      - type

  DomainEntity:
    inherits: Entity
    description: >-
      An Entity that is specific to a particular biomedical domain such as disease, therapeutics, or genes.
      Domain Entities are considered as 'concept-level' entities, as opposed to particular instances. e.g.
      'Lung Cancer', not 'patient123's lung cancer'. Or 'Erlotinib', not the particular doses given to a
      patient on a specific occasion.
    heritableProperties:
      mappings:
        type: array
        ordered: false
        items:
          $ref: "/ga4gh/schema/gks-common/1.x/data-types/json/ConceptMapping"
        description: >-
          A list of mappings to concepts in terminologies or code systems. Each mapping should
          include a coding and a relation.

  InformationEntity:
    inherits: Entity
    description: >-
      Information Entities are abstract (non-physical) entities that are about something (i.e. they carry
      information about things in the real world).
    heritableProperties:
      type:
        type: string
        const: InformationEntity
        default: InformationEntity
        description: MUST be "InformationEntity".
      specifiedBy:
        oneOf:
        - $ref: "#/$defs/Method"
        - $ref: "/ga4gh/schema/gks-common/1.x/data-types/json/IRI"
        description: >-
          A :ref:`Method` that describes all or part of the process through which the information was
          generated.
      contributions:
        type: array
        ordered: false
        items:
          $ref: "#/$defs/Contribution"
        description: >-
          A list of :ref:`Contribution` objects that describe the activities performed by agents upon this entity.
      isReportedIn:
        type: array
        ordered: false
        items:
          oneOf:
          - $ref: "#/$defs/Document"
          - $ref: "/ga4gh/schema/gks-common/1.x/data-types/json/IRI"
        description: A document in which the information content is expressed.
      dateAuthored:
        type: string
        format: datetime
        description: Indicates when the information content expressed in the Information Entity was generated.
      derivedFrom:
        type: array
        ordered: false
        items:
          $ref: "#/$defs/InformationEntity"
        description: Another Information Entity from which this Information Entity is derived, in whole or in part.
      recordMetadata:
        $ref: "#/$defs/RecordMetadata"
        description: Metadata that applies to a specific concrete record of information as encoded in a particular system.
    heritableRequired:
      - id
      - type

  Method:
    type: object
    inherits: InformationEntity
    maturity: draft
    description: >-
      A set of instructions that specify how to achieve some objective. These may vary in the level
      of detail they provide, and in scientific research, these include things like experimental 
      protocols, study designs, data analysis parameters,  curation guidelines, cohort selection
      criteria, and rule sets.
    properties:
      type:
        extends: type
        const: Method
        default: Method
        description: MUST be "Method".
      subtype:
        $ref: "/ga4gh/schema/gks-common/1.x/data-types/json/Coding"
        description: >-
          A specific type of method that a Method instance represents (e.g. 'Variant Interpretation
          Guideline', or 'Experimental Protocol')
        comments: >-
          This attribute can be used to report a specific type for the Method, in cases where a model
          does not define Method subclasses for this purpose.  Implementers can define their own set
          of method type codes/terms, to match the needs of their application.
      license:
        type: string
        description: >-
          A specific license that dictates legal permissions for how a method can be used (by whom,
          where, for what purposes, with what additional requirements, etc.)
        comments: >-
          Where possible, provide a URL pointing to the license or a description of it (e.g. 
          "https://creativecommons.org/licenses/by/4.0/"). Otherwise, provide a free-text name or
          description of the license (e.g. "CC-BY").

  Document:
    type: object
    inherits: InformationEntity
    maturity: draft
    description: a representation of a physical or digital document
    properties:
      type:
        extends: type
        const: Document
        default: Document
        description: Must be "Document"
      subtype:
        $ref: "/ga4gh/schema/gks-common/1.x/data-types/json/Coding"
        description: >-
          A more specific type for the document (e.g. a publication, patent, pathology report)
      title:
        type: string
        description: The title of the Document
      url:
        type: string
        description: A URL at which the document may be retrieved.
        format: uri
        pattern: "^(https?|s?ftp)://"
      doi:
        type: string
        pattern: "^10.(\\d+)(\\.\\d+)*/[\\w\\-\\.]+"
        description: >-
          A `Digital Object Identifier <https://www.doi.org/the-identifier/what-is-a-doi/>_`
          for the document.
      pmid:
        type: integer
        description: A `PubMed unique identifier <https://en.wikipedia.org/wiki/PubMed#PubMed_identifier>`_.

  Agent:
    type: object
    inherits: Entity
    maturity: draft
    description: >-
      An autonomous actor (person, organization, or software agent) that bears some form
      of responsibility for an activity taking place, for the existence of an entity, or for
      another agent's activity.
    properties:
      type:
        extends: type
        const: Agent
        default: Agent
        description: MUST be "Agent".
      name:
        type: string
        description: The descriptive name of the agent.
      subtype:
        type: string
        description: A more specific type of agent the agent represents.
        enum:
          - person
          - organization
          - software

  Activity:
    inherits: Entity
    maturity: draft
    description: >-
      An action or set of actions performed by an agent, that occurs over a period of time. Activities may use,
      generate, modify, move, or destroy one or more entities.
    heritableProperties:
      subtype:
        type:
          $ref: "/ga4gh/schema/gks-common/1.x/data-types/json/Coding"
        description: A more specific type of activity that an Activity object may represent.
      date:
        type: string
        format: date
        description: >-
          The date that the Activity was completed. The date SHOULD be formatted as a date string
          in ISO format "YYYY-MM-DD".
      performedBy:
        type: array
        ordered: false
        items:
          $ref: "#/$defs/Agent"
        description: >-
          An Agent who contributed to executing the Activity.
      specifiedBy:
        type: array
        ordered: false
        items:
          $ref: "#/$defs/Method"
        description: >-
          A method that was followed in performing an Activity, that describes how it was executed.

  Contribution:
    type: object
    inherits: Activity
    maturity: draft
    description: >-
      An action taken by an agent in contributing to the creation, modification, assessment, or
      deprecation of a particular entity (e.g. a Statement, EvidenceLine, DataItem, Publication, etc.)
    properties:
      type:
        extends: type
        const: Contribution
        default: Contribution
        description: MUST be "Contribution".
      contributor:
        extends: performedBy
        minItems: 1
        maxItems: 1
        description: >-
          The agent that made the contribution.
      activityType:
        $ref: "/ga4gh/schema/gks-common/1.x/data-types/json/Coding"
        description: >-
          The type of activity performed or role realized in making the contribution. MAY use
          terms from the Contributor Role Ontology (https://www.ebi.ac.uk/ols4/ontologies/cro),
          e.g. 'author role', 'evaluator role', 'data collection role'.

  RecordMetadata:
    type: object
    maturity: draft
    description: >-
      A reusable structure that encapsulates provenance metadata about a serialized data record or
      object in a particular dataset (as opposed to provenance about the real world entity this
      record or object represents).
    comment: >-
      Record-level metadata applies to a specific concrete encoding/serialization of information
      (e.g as a record in a specific data/knowlegebase, or an online digital resource).
      A RecordMetadata object can capture when, how, and by whom a specific record serialization was
      generated or modified; what upstream resources it was derived or retrieved from; and record-level
      administrative information such as versioning and lifecycle status. RecordMetadata objects should
      not be used to describe provenance of the abstract information content or knowledge captured in a
      data record or object - other properties in the model are defined to support this use case.
    properties:
      recordIdentifier:
        type: string
        description: >-
          The identifier of the data record or object described in this RecordMetadata object.
      recordVersion:
        type: string
        description: The version number of the record-level artifact the object describes.
      derivedFrom:
        type: string
        description: >-
          Another data record from which the record described here was derived, through a data
          ingest and/or transformation process. Value should be a string representing the identifier
          of the source record.
      dateRecordCreated:
        type: string
        format: datetime
        description: The date the record was initially created.
      contributions:
        type: array
        ordered: false
        items:
          $ref: "#/$defs/Contribution"
        description: >-
          Describes specific contributions made by an human or software agent to the creation,
          modification, or administrative management of a data record or object.

  EvidenceLine:
    inherits: InformationEntity
    maturity: draft
    type: object
    description: >-
      A discrete, independent argument relevant to the validity of the Proposition assessed or put forth as
      true in a Statement. This argument is based on an interpretation of one or more pieces of information
      as evidence (i.e. Evidence Items).
    properties:
      type:
        extends: type
        const: EvidenceLine
        default: EvidenceLine
        description: Must be "EvidenceLine"
      # Note that the `proposition` property below is a proposed addition to the EvidenceLine class that is not
      # yet implemented in the core IM.
      #
      # targetProposition:
      #   $ref: "#/$defs/Proposition"
      #   description: >-
      #     The possible fact against which evidence items contained in an Evidence Line were collectively evaluated,
      #     in determining the overall strength and direction of support they provide. e.g. in an ACMG Guideline-based
      #     assessment of variant pathogenicity, the support provided by distinct lines of evidence are assessed against
      #     a target proposition that a variant is pathogenic for a specific disease.
      evidenceItems:
        type: array
        ordered: false
        items:
          $ref: "#/$defs/InformationEntity"
        description: >-
          An individual piece of information that was evaluated as evidence in building the argument represented
          by an Evidence Line.
      directionOfEvidenceProvided:
        type: string
        enum: [ "supports", "neutral", "disputes" ]
        description: >-
          The direction the Evidence Line favors its target Proposition (can be supporting, disputing, or neutral)
      strengthOfEvidenceProvided:
        oneOf:
          - $ref: "/ga4gh/schema/gks-common/1.x/data-types/json/Coding"
          - $ref: "/ga4gh/schema/gks-common/1.x/data-types/json/IRI"
        description: >-
          A qualitative strength of all evidence items assessed within the context of the target Proposition
          in the direction indicated by the directionOfEvidenceProvided value.
      scoreOfEvidenceProvided:
        type: number
        description: >-
          A quantitative score (or weight) of all evidence items assessed within the context of the target Proposition
          in the direction indicated by the directionOfEvidenceProvided value.

  Statement:
    inherits: InformationEntity
    description: >-
      A Statement (aka "Assertion") represents a claim of purported truth as made by a particular agent,
      on a particular occasion.
    heritableProperties:
      subject:
        oneOf:
        - type: object
        description: The subject of the Statement.
      predicate:
        type: string
        description: The predicate of the Statement.
      object:
        oneOf:
        - type: object
        description: The object of the Statement.
      direction:
        type: string
        enum:
          - supports
          - neutral
          - disputes
        description: >-
          The direction of this Statement with respect to the predicate.
      strength:
        oneOf:
          - $ref: "/ga4gh/schema/gks-common/1.x/data-types/json/Coding"
          - $ref: "/ga4gh/schema/gks-common/1.x/data-types/json/IRI"
        description: >-
          A qualitative term indicating the overall strength of support for or against the Statement
          based on all evidence assessed.
      score:
        type: number
        description: >-
          A quantitative score indicating the overall strength of support for or against the Statement
          based on all evidence assessed.
      statementText:
        type: string
        description: >-
          A natural-language expression of what a structured Statement object asserts to be true.
          e.g. for a Variant Pathogenicity statement, "BRCA2 c.8023A>G is pathogenic for Breast
          Cancer", or "there is moderate evidence supporting the pathogenicity of BRCA2 c.8023A>G
          for Breast Cancer".
      # Note that the `proposition` property below is a proposed addition to the Statement class that is not yet
      # implemented in the core IM.
      #
      # proposition:
      #   $ref: "#/$defs/Proposition"
      #   description:  >-
      #     A possible fact that the Statement assesses or puts forth as true. This attribute provides
      #     the option of encapsulating the structured semantics of the possible fact asserted or
      #     evaluated by a Statement in a separate 'Proposition' object - instead of using the subject,
      #     predicate, object, qualifier properties directly in the Statement object.
      subjectClassification:
        oneOf:
          - $ref: "/ga4gh/schema/gks-common/1.x/data-types/json/Coding"
          - $ref: "/ga4gh/schema/gks-common/1.x/data-types/json/IRI"
        description: >-
          A single term or phrase summarizing the outcome of direction and strength
          assessments of a Statement's proposition, in terms of a classification of the
          Statement's subject. Permissible values for this attribute are typically
          selected to be succinct and familiar in the target community of practice. e.g. 
          'likely pathogenic' in the domain of variant pathogenicity classification'.
      hasEvidenceLines:
        type: array
        ordered: false
        items:
          $ref: "#/$defs/EvidenceLine"
        description: >-
          A discrete, independent argument relevant to the validity of the Proposition assessed or put forth in the Statement. This argument is based on the interpretation of one or more pieces of information as evidence.
          argument is based on the interpretation of one or more pieces of information as evidence.
    heritableRequired:
      - subject
      - direction

  DataSet:
    inherits: InformationEntity
    maturity: draft
    type: object
    description: >-
      A collection of related data items or records that are organized together in a common format
      or structure, to enable their computational manipulation as a unit.
    properties:
      type:
        extends: type
        const: DataSet
        default: DataSet
        description: MUST be "DataSet".
      subtype:
        $ref: "/ga4gh/schema/gks-common/1.x/data-types/json/Coding"
        description: >-
          A specific type of data set the DataSet object represents (e.g. a clinical data set,
          a sequencing data set, a gene expression data set, a genome annotation data set)
      releaseDate:
        type: string
        format: datetime
        description: Indicates when a version of a Data Set was formally released.
      version:
        type: string
        description: The version of the Data Set, as assigned by its creator.
      license:
        type: string
        description: >-
          A license that dictates legal permissions for how the Data Set can be used -
          referenced by a URL where possible.

  StudyResult:
    inherits: InformationEntity
    maturity: draft
    description: >-
      A collection of data items from a single study that are about a particular subject or experimental
      unit in the study, along with optional provenance information describing how these data items were
      generated. StudyResult objects provide a flexible and useful way to summarize a subset of data items
      from a larger study that are cited as evidence in curation workflows that generate higher order
      knowledge about a particular variant or other entity.
    heritableProperties:
      focus:
        oneOf:
          - $ref: "#/$defs/DomainEntity"
          - $ref: "/ga4gh/schema/gks-common/1.x/data-types/json/Coding"
          - $ref: "/ga4gh/schema/gks-common/1.x/data-types/json/IRI"
        description: >-
          The specific subject or experimental unit in a Study that data in the StudyResult object is about.
          e.g. a particular variant in a population allele frequency dataset like ExAC or gnomAD.
      sourceDataSet:
        extends: derivedFrom
        items:
          $ref: "#/$defs/DataSet"
        maximum: 1
        description: >-
          A larger Data Set from which the content of the Result was derived.
      componentResult:
        type: array
        ordered: false
        items:
          $ref: "#/$defs/StudyResult"
        description: >-
          A Study Result comprised of data items about the same focus as its parent Result, but based on a
          analysis of a different subset of the data pertaining to that focus (e.g. data from analysis of a
          subset of the full Study Group).
      studyGroup:
        $ref: "#/$defs/StudyGroup"
        description: >-
          A structured description of specific population of subjects interrogated in the Research Study to
          produce the subset of data captured in the StudyResult.
      ancillaryResults:
        maturity: draft
        $comment: This field is different from most GKS objects by allowing any content to be added, and so is independently versioned.
        type: object
        additionalProperties: true
      qualityMeasures:
        maturity: draft
        $comment: This field is different from most GKS objects by allowing any content to be added, and so is independently versioned.
        type: object
        additionalProperties: true

  StudyGroup:
    inherits: Entity
    maturity: draft
    type: object
    description: >-
      A collection of individuals or specimens from the same taxonomic class, selected for analysis in a scientific
      study based on their exhibiting one or more common characteristics  (e.g. species, ethnicity, race, country of
      origin, clinical history, age, gender, geographic location, income, etc.) May be referred to as a 'cohort' or
      'population' in specific research settings.
    properties:
      type:
        extends: type
        const: StudyGroup
        default: StudyGroup
        description: Must be "StudyGroup"
      memberCount:
        type: integer
        description: the total number of individual members in the study group
      isSubsetOf:
        type: array
        items:
          $ref: "#/$defs/StudyGroup"
        ordered: false
        description: A larger study group of which this study group represents a subset.
      characteristics:
        type: array
        items:
          $ref: "#/$defs/Characteristic"
        ordered: false
        description: >-
          A feature or characteristic shared by all members of the study group, and representing a criteria for
          membership in the group.

  Characteristic:
    type: object
    maturity: draft
    description: >-
      An object holding a name-value pair used to describe any characteristic of an individual member of a
      Study Group (e.g. name = sex, value = female)
    properties:
      name:
        type: string
        description: >-
          The type of the feature/trait described by the characteristic
          (e.g. 'ethnicity', 'sex', 'age', 'disease status').
      value:
        type: string
        description: >-
          The specific value(s) that the indicated feature/trait holds in all population members
          (e.g. 'east asian', 'female', 'adolescent', 'cancer').
      exclude:
        type: boolean
        description: >-
          A boolean attribute set to TRUE if the characteristic must be absent to qualify as a member of a
          study group or population.
    required:
      - name
      - value


  # Note that the `Proposition` class below is a proposed addition to both the Statement and EvidenceLine
  # classes that is not yet implemented in the core IM.
  #
  # Proposition:
  #   inherits: Entity
  #   maturity: draft
  #   type: object
  #   description: >-
  #     The abstract entity representing a possible fact that may be put forth as true, or subjected to
  #     an evidence-based assessment, by a Statement. As abstract entities, their identity and existence
  #     are independent of space and time, and whether they are ever asserted to be true by some agent.
  #     Propositions may be used in two contexts; (1) by Statements that assert them to be true or false,
  #     or describe the overall level of confidence/evidence for or against them; (2) by Evidence Lines that
  #     report the direction and strength of an evidence-based argument for the Proposition.
  #   properties:
  #     type:
  #       extends: type
  #       const: Proposition
  #       default: Proposition
  #       description: Must be "Proposition"
  #     statementText:
  #       type: string
  #       description: >-
  #        A natural-language expression of the Proposition's meaning. e.g. "BRCA2 c.8023A>G is pathogenic for
  #        Breast Cancer".
  #     subject:
  #       type:
  #         $ref: "#/$defs/Entity"
  #       description: The Entity or concept about which the Proposition is made.
  #     predicate:
  #       type:
  #         $ref: "/ga4gh/schema/gks-common/1.x/data-types/json/Coding"
  #       description: The relationship asserted to hold between the subject and the object of the Proposition.
  #     object:
  #       type:
  #         $ref: "#/$defs/Entity"
  #       description: An Entity that is related to the subject of a Proposition via its predicate.
  #     negated:
  #       type: boolean
  #       description: >-
  #         A boolean flag set to 'true' to represent a negation of the proposition expressed by the subject, predicate,
  #         object, and qualifiers (e.g. that "Variant X is NOT pathogenic for Disease Y")/
  #   heritableRequired:
  #     - subject
  #     - predicate
  #     - object
