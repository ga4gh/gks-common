$schema: "https://json-schema.org/draft/2020-12/schema"
$id: "https://w3id.org/ga4gh/schema/gks-common/1.x/common-source.yaml"
title: GKS Common Library Definitions
strict: true

$defs:
  Entity:
    description: >-
      Entity is the root class of 'common' classes model - those that have identifiers and other general
      metadata like labels, xrefs, urls, descriptions, etc. All common classes descend from and inherit
      its attributes.
    heritableProperties:
      id:
        type: string
        description: >-
          The 'logical' identifier of the entity in the system of record, e.g. a UUID. This 'id' is
          unique within a given system. The identified entity may have a different 'id' in a different
          system, or may refer to an 'id' for the shared concept in another system (e.g. a CURIE).
      label:
        type: string
        description: A primary label for the entity.
      description:
        type: string
        description: A free-text description of the entity.
      mappings:
        type: array
        ordered: false
        items:
          $ref: "#/$defs/ConceptMapping"
      extensions:
        type: array
        ordered: true
        items:
          $ref: "#/$defs/Extension"

  Coding:
    type: object
    maturity: draft
    description: a concept codified by a terminology system.
    properties:
      label:
        type: string
        description: A primary label for the coding.
      system:
        type: string
        description: Identity of the terminology system.
      version:
        type: string
        description: Version of the terminology system.
      code:
        $ref: '#/$defs/Code'
        description: Symbol in syntax defined by the terminology system.
    required:
      - system
      - code

  ConceptMapping:
    type: object
    maturity: draft
    description: >-
      A mapping to a concept in a terminology or code system.
    properties:
      coding:
        $ref: '#/$defs/Coding'
      relation:
        description: >-
          A mapping relation between concepts as defined by the Simple Knowledge Organization System (SKOS).
        type: string
        enum:
          - closeMatch
          - exactMatch
          - broadMatch
          - narrowMatch
          - relatedMatch
    required:
      - relation
      - coding

  Extension:
    type: object
    maturity: draft
    description: >-
      The Extension class provides entities with a means to include
      additional attributes that are outside of the specified standard
      but needed by a given content provider or system implementer.
      These extensions are not expected to be natively understood, but
      may be used for pre-negotiated exchange of message attributes
      between systems.
    properties:
      type:
        type: string
        const: Extension
        description: MUST be "Extension".
      name:
        type: string
        description: A name for the Extension
      value:
        type: [ "number", "string", "boolean", "object", "array", "null" ]
        description: Any primitive or structured object
    required: [ "name" ]

  Code:
    maturity: draft
    description: >-
      Indicates that the value is taken from a set of controlled strings defined elsewhere.
      Technically, a code is restricted to a string which has at least one character and no leading or
      trailing whitespace, and where there is no whitespace other than single spaces in the contents.
    type: string
    pattern: '\S+( \S+)*'
    example: ENSG00000139618

  IRI:
    maturity: draft
    description: >-
      An IRI Reference (either an IRI or a relative-reference), according to `RFC3986 section 4.1
      <https://datatracker.ietf.org/doc/html/rfc3986#section-4.1>` and `RFC3987 section 2.1
      <https://datatracker.ietf.org/doc/html/rfc3987#section-2.1>`. MAY be a JSON Pointer as an IRI fragment, as
      described by `RFC6901 section 6 <https://datatracker.ietf.org/doc/html/rfc6901#section-6>`.
    type: string
    format: iri-reference

  DomainEntity:
    inherits: Entity
    description: >-
      An Entity that is specific to a particular biomedical domain such as disease, therapeutics, or genes.
      Domain Entities are considerd as 'concept-level' entities, as opposed to particular instances. e.g. 
      'Lung Cancer', not 'patient123's lung cancer'. Or 'Erlotinib', not the particular doses given to a 
      patient on a specific occasion.
    heritableProperties:
      type:
        type: string
      aliases:
        description: Aliases are alternate labels for a Domain Entity.
        ordered: false
        type: array
        items:
          type: string
    heritableRequired:
      - type
      
  Expression:
    type: object
    maturity: draft
    description: >-
      Representation of a variation by a specified nomenclature or syntax for a Variation object.
      Common examples of expressions for the description of molecular variation include the HGVS
      and ISCN nomenclatures.
    properties:
      syntax:
        type: string
        enum: ["hgvs.c", "hgvs.p", "hgvs.g", "hgvs.m", "hgvs.n", "hgvs.r", "iscn", "gnomad", "spdi"]
      value:
        type: string
      syntax_version:
        type: string
    required:
      - syntax
      - value
